{
  "simple": {
    "query_type": "simple",
    "queries": [
      {
        "name": "simple_select_authors",
        "query": "db.author.find({}, { author_fullname: 1, _id: 0 })"
      },
      {
        "name": "simple_count",
        "query": "db.author.distinct('author_fullname').length"
      },
      {
        "name": "simple_unique",
        "query": "db.author.distinct('author_fullname')"
      },
      {
        "name": "simple_select_posts",
        "query": "db.post.find({}, { title: 1, _id: 0 })"
      },
      {
        "name": "simple_count_posts",
        "query": "db.post.countDocuments()"
      },
      {
        "name": "simple_unique_subreddits",
        "query": "db.subreddit.distinct('display_name')"
      },
      {
        "name": "simple_select_comments",
        "query": "db.comment.find({}, { body: 1, _id: 0 })"
      },
      {
        "name": "simple_count_comments",
        "query": "db.comment.countDocuments()"
      },
      {
        "name": "simple_unique_comment_authors",
        "query": "db.comment.distinct('author_fullname')"
      },
      {
        "name": "simple_select_wiki_paths",
        "query": "db.wiki.find({}, { path: 1, _id: 0 })"
      }
    ]
  },
  "joins": {
    "query_type": "join",
    "queries": [
      {
        "name": "join_select_authors",
        "query": "db.post.aggregate([{ $lookup: { from: 'author', localField: 'author_fullname', foreignField: 'author_fullname', as: 'author_info' } }, { $unwind: '$author_info' }, { $project: { author_fullname: 1, author: '$author_info.author', _id: 0 } }])"
      },
      {
        "name": "join_count",
        "query": "db.post.aggregate([{ $lookup: { from: 'author', localField: 'author_fullname', foreignField: 'author_fullname', as: 'author_info' } }, { $unwind: '$author_info' }, { $group: { _id: null, count: { $sum: 1 } } }])"
      },
      {
        "name": "join_unique",
        "query": "db.post.aggregate([{ $lookup: { from: 'author', localField: 'author_fullname', foreignField: 'author_fullname', as: 'author_info' } }, { $unwind: '$author_info' }, { $group: { _id: '$author_fullname' } }])"
      },
      {
        "name": "join_posts_subreddits",
        "query": "db.post.aggregate([{ $lookup: { from: 'subreddit', localField: 'subreddit_id', foreignField: 'id', as: 'subreddit_info' } }, { $unwind: '$subreddit_info' }, { $project: { title: 1, subreddit_name: '$subreddit_info.display_name', _id: 0 } }])"
      },
      {
        "name": "join_comments_posts",
        "query": "db.comment.aggregate([{ $lookup: { from: 'post', localField: 'link_id', foreignField: 'id', as: 'post_info' } }, { $unwind: '$post_info' }, { $project: { comment_body: '$body', post_title: '$post_info.title', _id: 0 } }])"
      },
      {
        "name": "join_comments_authors",
        "query": "db.comment.aggregate([{ $lookup: { from: 'author', localField: 'author_fullname', foreignField: 'author_fullname', as: 'author_info' } }, { $unwind: '$author_info' }, { $project: { comment_body: '$body', author_name: '$author_info.author', _id: 0 } }])"
      },
      {
        "name": "join_wiki_subreddits",
        "query": "db.wiki.aggregate([{ $lookup: { from: 'subreddit', localField: 'subreddit', foreignField: 'display_name', as: 'subreddit_info' } }, { $unwind: '$subreddit_info' }, { $project: { path: 1, subreddit_title: '$subreddit_info.title', _id: 0 } }])"
      },
      {
        "name": "join_subreddit_rules",
        "query": "db.subreddit_rules.aggregate([{ $lookup: { from: 'subreddit', localField: 'subreddit', foreignField: 'display_name', as: 'subreddit_info' } }, { $unwind: '$subreddit_info' }, { $project: { rule_id: 1, subreddit_title: '$subreddit_info.title', _id: 0 } }])"
      },
      {
        "name": "join_post_comment_counts",
        "query": "db.comment.aggregate([{ $group: { _id: '$link_id', comment_count: { $sum: 1 } } }, { $lookup: { from: 'post', localField: '_id', foreignField: 'id', as: 'post_info' } }, { $unwind: '$post_info' }, { $project: { post_title: '$post_info.title', comment_count: 1, _id: 0 } }])"
      },
      {
        "name": "join_subreddit_metadata",
        "query": "db.subreddit.aggregate([{ $lookup: { from: 'subreddit_metadata', localField: 'display_name', foreignField: 'display_name', as: 'metadata' } }, { $unwind: '$metadata' }, { $project: { display_name: 1, num_posts: '$metadata.num_posts', _id: 0 } }])"
      }
    ]
  },
  "advanced": {
    "query_type": "advanced",
    "queries": [
      {
        "name": "advanced_select_authors",
        "query": "db.author.aggregate([{ $match: { author_premium: true } }, { $project: { author_fullname: 1, _id: 0 } }])"
      },
      {
        "name": "advanced_count",
        "query": "db.author.aggregate([{ $match: { author_premium: true } }, { $group: { _id: null, count: { $sum: 1 } } }])"
      },
      {
        "name": "advanced_unique",
        "query": "db.author.distinct('author_fullname', { author_premium: true })"
      },
      {
        "name": "advanced_top_posts",
        "query": "db.post.find().sort({ score: -1 }).limit(10)"
      },
      {
        "name": "advanced_most_active_subreddits",
        "query": "db.post.aggregate([{ $group: { _id: '$subreddit_id', post_count: { $sum: 1 } } }, { $sort: { post_count: -1 } }, { $limit: 5 }])"
      },
      {
        "name": "advanced_average_comment_score",
        "query": "db.comment.aggregate([{ $group: { _id: null, avg_score: { $avg: '$score' } } }])"
      },
      {
        "name": "advanced_posts_with_high_comments",
        "query": "db.post.find({ num_comments: { $gt: 100 } }, { title: 1, num_comments: 1, _id: 0 })"
      },
      {
        "name": "advanced_subreddits_with_rules",
        "query": "db.subreddit_rules.aggregate([{ $group: { _id: '$subreddit', rule_count: { $sum: 1 } } }, { $sort: { rule_count: -1 } }])"
      },
      {
        "name": "advanced_comments_by_author",
        "query": "db.comment.aggregate([{ $group: { _id: '$author_fullname', comment_count: { $sum: 1 } } }, { $sort: { comment_count: -1 } }, { $limit: 5 }])"
      },
      {
        "name": "advanced_recent_wiki_edits",
        "query": "db.wiki.find().sort({ revision_date: -1 }).limit(5)"
      }
    ]
  },
  "nested": {
    "query_type": "nested",
    "queries": [
      {
        "name": "nested_top_authors",
        "query": "db.comment.aggregate([{ $group: { _id: '$author_fullname', comment_count: { $sum: 1 } } }, { $sort: { comment_count: -1 } }, { $limit: 5 }])"
      },
      {
        "name": "nested_subreddit_post_counts",
        "query": "db.post.aggregate([{ $group: { _id: '$subreddit_id', post_count: { $sum: 1 } } }, { $sort: { post_count: -1 } }])"
      },
      {
        "name": "nested_average_post_score",
        "query": "db.post.aggregate([{ $group: { _id: null, avg_score: { $avg: '$score' } } }])"
      },
      {
        "name": "nested_comments_per_post",
        "query": "db.comment.aggregate([{ $group: { _id: '$link_id', comment_count: { $sum: 1 } } }, { $sort: { comment_count: -1 } }])"
      },
      {
        "name": "nested_top_subreddits_by_comments",
        "query": "db.comment.aggregate([{ $group: { _id: '$subreddit_id', comment_count: { $sum: 1 } } }, { $sort: { comment_count: -1 } }, { $limit: 5 }])"
      },
      {
        "name": "nested_distinct_authors_in_subreddit",
        "query": "db.comment.aggregate([{ $match: { subreddit_id: 't5_example' } }, { $group: { _id: '$author_fullname' } }])"
      },
      {
        "name": "nested_most_awarded_posts",
        "query":
::contentReference[oaicite:0]{index=0}

